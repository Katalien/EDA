# Computer vision EDA (Exploratory data analysis)
Проект предназначен для анализа наборов данных, 
содержащих изображения и соответствующие им маски. 
Он предоставляет способ извлечения и анализа различных 
характеристик изображений и генерирует  отчет в формате PDF. 
Анализ настраивается с помощью конфигурационного файла,
позволяя выбирать, какие статистики использовать
и как их визуализировать. Кроме того, в проекте поддерживается 
возможность сохранения результатов анализа в формате JSON для более 
быстрого составления повторных отчетов.

### Характеристики (features)

#### General features. Общие статистики по всему изображению:
- Brightness - общая яркость изображения
- AspectRatio - соотношение сторон изображения
- Color - гистограмма распределения цветов (r, g, b)
- Contrast - контрастность изображения
#### Labels features. Характеристики помеченных объектов на изображении
- ClassesFrequency - общее количество объектов одного класса во всем датасете
- InstancesPerImage - количество объектов одного класса на изображении
- LocationsMap - объединяет все маски объектов для создания составной карты, которая визуализирует перекрытие объектов. В результирующем изображении пикселям присваиваются значения яркости в зависимости от частоты их появления в масках объектов.
- ClassesArea - площадь объектов на изображении
- ClassesBbAspectRatio - отношение сторон ограничивающего прямоугольника объекта
- ClassesDiameter - диаметр объектов
- Class2ImageRatio - отношение площади ограничивающего прямоугольника объекта ко всей площади изображения
#### Masks features. Статистики маскированных областей на изображении:
- MaskedContrast - контраст маскированной области (объекта)
- MaskedBrightness - яркость маскированной области 
- MaskedGradient - градиент маскированой области
#### CompareFeatures. Сравнение общих и маскированных фичей на одном графике: 
- CompareMaskedBrightness - сравнение на одном графике общей яркости изображения и яркости объекта
- CompareMaskedContrast - сравнение на одном графике общего контраста изображения и контраста объекта


### Способы визуализации статистик (visualization methods)
- <Способ визуализации>:  "<Название тега в конфиг файле>"
- Bar plot: "bar"
- BoxPlot: "boxplot" 
- Density plot: "density": 
- Histogram: "histogram"
- Line plot: "line"
- Scatter plot: "scatter"
- Violin plot: "violin"

## How it works
Датасет со всеми изображениями и масками может храниться в одной директории или каждый экземпляр
(изображение и маски) могут быть разбиты на соответсвующие поддиректории.
Название изображения и соответсвующих масок должно совпадать. Маска должна иметь тэг, разделенный с названием нижним 
подчеркиванием (пр: name_mask.tiff). Все изображения должны иметь одинаковое расширение, все маски также должны 
быть с оним расширением.


### Структура конфигурациооного файла .yaml:
- __Dataset Path__: путь к датасету
- __Output Path__: путь для сохранения отчета в формате пдф с названием файла
- __Classes__: словарь, где ключи это теги масок в датасете, ключи - соответсвующие
названия масок в итоговом отчете
- __Save Json__: (optional) Путь для сохранения результатов в формате json для повторной
генерации отчета 
- __Ext__:
  - image_ext: Расширение изображений
  - mask_ext: Расширение масок

- __Features__: Фичи для анализа
  - Название фичи:
    visualization_methods: список способов визуализации
- __CompareFeatures__: (optional) Фичи для сравнения
  - Название фичи:
    - features: список сравниваемых фичей
    - visualization_methods: список способов визуализации

### Run
1. Для анализа датасета опишите конфигурационный файл.
2. Анализ датасета:  
``` 
    python main.py analyze_dataset --config <path_to_config_file>
   ```
2. Генерация отчета по метафайлу .json
```commandline
pthon main.py analyze_metafile --json <path_to_json> --output <path_to_save_report>
```